# Carrega o pacote
library(rredlist)

# Chave de acesso ao API da IUCN
token = "f2f5219c064c14dd5b649c74320c9dc6e889a535686dd9b8ec2adde960ac6582"

# Carrega as especies de aves do Brasil, segundo a BirdLife
# A lista inclui "vagrant/accidental, uncertain and introduced country/territory records"
birdlife = read.csv("https://raw.githubusercontent.com/buenoas/aves_Brasil/main/Brazil_full_spp_list_BirdLife_2022.txt",
                    sep = "\t")

# Extrai o historico de avaliacao das especies
spp_history = list()

for (i in 1:length(birdlife$Scientific.name)) {

  spp_history[[i]] = as.data.frame(
    rl_history(birdlife$Scientific.name[i], key = token))
  
  print(i)
    
}

spp_history = do.call(rbind, spp_history)
